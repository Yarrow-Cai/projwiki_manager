---
title: [硬件接口名称]
category: hardware
date: YYYY-MM-DD
author: Yarrow
tags: [外设类型, 功能标签]
status: draft
mcu: GD32G553QET7
---

# [硬件接口名称]

## 概述

简要描述该硬件接口的功能、用途和在系统中的角色（1-3句话）。

**目标MCU**：GD32G553QET7（Arm Cortex-M33, 216MHz）
**相关外设**：[外设名称，如TIMER0、ADC0、CMP0等]
**BSP驱动**：`Hardware/BSP_xxx.c` / `Hardware/BSP_xxx.h`

## 引脚映射

### 功能引脚分配

| 引脚 | GPIO端口 | 复用功能 | 方向 | 电气特性 | 功能说明 |
|------|---------|---------|------|---------|---------|
| Pin_X | PAx | AFx | 输出 | 推挽/3.3V | 功能说明 |
| Pin_X | PBx | AFx | 输入 | 浮空/上拉 | 功能说明 |
| Pin_X | PCx | Analog | 输入 | 模拟输入 | ADC采样通道 |

### 引脚电气参数

| 引脚 | 最大电压 | 最大电流 | 驱动能力 | ESD等级 | 备注 |
|------|---------|---------|---------|---------|------|
| PAx | 3.3V | 25mA | 高速 | 2kV HBM | - |
| PBx | 5V容忍 | - | - | 2kV HBM | 输入引脚 |

### 引脚连接示意

```
                    GD32G553QET7
                   ┌────────────┐
  [外部器件A] ────>│ PAx (AFx)  │──── PWM输出
  [外部器件B] ────>│ PBx (AN)   │──── ADC输入
  [外部器件C] <────│ PCx (GPIO) │──── 使能信号
                   └────────────┘
```

## 外设配置

### 时钟配置

| 外设 | 时钟源 | 时钟频率 | 分频系数 | 使能寄存器 |
|------|--------|---------|---------|-----------|
| 外设1 | APB2 | 216MHz | /1 | RCU_APB2EN |
| 外设2 | APB1 | 108MHz | /2 | RCU_APB1EN |
| GPIO | AHB1 | 216MHz | /1 | RCU_AHB1EN |

### 寄存器关键配置

| 寄存器 | 偏移地址 | 配置值 | 位域说明 |
|--------|---------|--------|---------|
| REG_CTL0 | 0x00 | 0xXXXX | [15:8] 模式选择, [7:0] 使能位 |
| REG_CFG | 0x04 | 0xXXXX | [31:16] 预分频, [15:0] 周期值 |

### DMA配置（如适用）

| DMA通道 | 外设请求 | 方向 | 数据宽度 | 缓冲大小 | 模式 |
|---------|---------|------|---------|---------|------|
| DMA_CHx | 外设请求源 | 外设→内存 | 16bit | X words | 循环 |

## 电气接口规格

### 信号特性

| 信号名 | 类型 | 电平标准 | 频率/速率 | 阻抗 | 说明 |
|--------|------|---------|----------|------|------|
| PWM_OUT | 数字输出 | 0~3.3V | XkHz | - | 逆变器驱动 |
| V_SENSE | 模拟输入 | 0~3.3V | - | 高阻 | 电压采样 |
| I_SENSE | 模拟输入 | 0~3.3V | - | 高阻 | 电流采样 |
| EN_SIG | 数字输出 | 0/3.3V | - | - | 使能控制 |

### 信号调理电路

描述外部信号调理电路（分压、滤波、运放等）。

```
传感器输出 ──[R1]──┬──[R2]──GND
                   │
                   ├──[C1]──GND
                   │
                   └──> MCU ADC输入
                   
分压比: Vout = Vin * R2/(R1+R2)
滤波截止频率: fc = 1/(2*pi*R_eq*C1)
```

### 电压/电流转换关系

| 物理量 | 传感器 | 量程 | ADC对应范围 | 转换公式 | 精度 |
|--------|--------|------|-----------|---------|------|
| 直流电压 | 分压电阻 | 0~500V | 0~3.3V | V = ADC * 500/4096 | ±0.5% |
| 直流电流 | 霍尔传感器 | 0~30A | 0~3.3V | I = (ADC - 2048) * 30/2048 | ±1% |
| 温度 | NTC热敏电阻 | -40~125°C | 0~3.3V | 查表法 | ±2°C |

## 时序参数

> **WARNING**: 时序参数为安全关键参数，修改前需要示波器验证！

### PWM时序（如适用）

| 参数 | 最小值 | 典型值 | 最大值 | 单位 | 说明 |
|------|--------|--------|--------|------|------|
| PWM频率 | - | X | - | kHz | 开关频率 |
| PWM分辨率 | - | X | - | bit | 占空比分辨率 |
| 死区时间 | X | X | X | ns | GaN/MOSFET死区 |
| 上升时间 | - | X | X | ns | 驱动信号上升沿 |
| 下降时间 | - | X | X | ns | 驱动信号下降沿 |
| 最小脉宽 | X | - | - | ns | 有效脉冲最小宽度 |
| 最大占空比 | - | - | X | % | 占空比上限 |

### ADC采样时序（如适用）

| 参数 | 值 | 单位 | 说明 |
|------|-----|------|------|
| 采样时间 | X | ADC时钟周期 | 每通道采样保持时间 |
| 转换时间 | X | us | 单次转换耗时 |
| 扫描周期 | X | us | 全通道扫描一轮 |
| 触发源 | TIMER_TRGO | - | 定时器触发启动 |
| 采样点 | PWM周期中点 | - | 减小开关噪声影响 |

### 通信时序（如适用）

| 参数 | 值 | 单位 | 说明 |
|------|-----|------|------|
| 波特率 | X | bps | 通信速率 |
| 数据位 | 8 | bit | 数据帧长度 |
| 停止位 | 1 | bit | 停止位数量 |
| 校验 | None/Even/Odd | - | 校验方式 |

## 驱动接口

### BSP层接口函数

| 函数名 | 参数 | 返回值 | 说明 |
|--------|------|--------|------|
| `BSP_xxx_Init()` | void | void | 外设初始化 |
| `BSP_xxx_Config()` | 配置参数 | 状态码 | 参数配置 |
| `BSP_xxx_Enable()` | void | void | 使能外设 |
| `BSP_xxx_Disable()` | void | void | 禁用外设 |
| `BSP_xxx_Read()` | 通道/地址 | 数据值 | 读取数据 |
| `BSP_xxx_Write()` | 通道, 数据 | 状态码 | 写入数据 |

### 中间层封装接口

| 函数名 | 参数 | 返回值 | 说明 |
|--------|------|--------|------|
| `MDW_xxx_Read()` | 通道 | 物理量值 | 带校准的读取 |
| `MDW_xxx_SetOutput()` | 物理量值 | 状态码 | 带限幅的输出 |

## 中断配置

| 中断源 | 向量号 | 优先级（抢占/子） | 触发条件 | 处理函数 | 执行时间 |
|--------|--------|------------------|---------|---------|---------|
| 中断1 | IRQn_X | X/X | 条件说明 | `ISR_Handler()` | <Xus |
| 中断2 | IRQn_X | X/X | 条件说明 | `ISR_Handler()` | <Xus |

> **WARNING**: 中断优先级数值越小优先级越高。过流保护中断必须设为最高优先级！

## 保护与安全

> **WARNING**: 安全关键接口，修改需要硬件验证和安全评审！

### 硬件保护机制

| 保护类型 | 检测方式 | 阈值 | 响应时间 | 保护动作 |
|---------|---------|------|---------|---------|
| 过压保护 | 比较器CMP | XV | <Xus | 关断PWM输出 |
| 过流保护 | 比较器CMP | XA | <Xus | 关断PWM输出 |
| 过温保护 | ADC+软件 | X°C | <Xms | 降额/关断 |
| 短路保护 | 硬件逐脉冲 | XA | <Xns | 立即关断 |

### 故障恢复策略

| 故障类型 | 自动恢复 | 恢复条件 | 恢复延时 | 最大重试次数 |
|---------|---------|---------|---------|------------|
| 过压 | 是 | 电压恢复至安全范围 | Xms | X次 |
| 过流 | 是 | 电流恢复至安全范围 | Xms | X次 |
| 过温 | 是 | 温度降至安全范围 | Xs | 不限 |
| 短路 | 否 | 人工排查后复位 | - | - |

### 死区与驱动安全

> **WARNING**: 死区时间直接关系GaN/SiC器件安全，严禁缩短！

- 最小死区时间：Xns（硬件决定，不可软件覆盖）
- 推荐死区时间：Xns（含安全裕量）
- 驱动电压：VGS = +XV / -XV
- 驱动电流：峰值XA

## 校准与标定

### 校准参数

| 参数名 | 默认值 | 工厂校准范围 | 单位 | 校准方法 | 存储地址 |
|--------|-------|-------------|------|---------|---------|
| V_offset | 0 | ±50 | LSB | 短路输入标零 | Flash addr |
| V_gain | 1.0000 | 0.95~1.05 | - | 已知电压源标定 | Flash addr |
| I_offset | 2048 | 2000~2096 | LSB | 零电流标零 | Flash addr |
| I_gain | 1.0000 | 0.95~1.05 | - | 已知电流源标定 | Flash addr |

### 校准流程

1. 断开负载，确保零输入状态
2. 读取ADC原始值作为偏移校准值（offset）
3. 施加已知标准输入（电压源/电流源/标准温度）
4. 计算增益校准系数（gain）
5. 将校准参数写入Flash指定地址
6. 验证校准后精度是否达标

## PCB布局注意事项

- 高频信号走线尽量短且直，避免锐角
- ADC采样线远离PWM驱动线和功率回路
- 模拟地与数字地单点汇合
- 去耦电容紧靠外设供电引脚放置
- 驱动信号线使用差分布线（如适用）
- 电流采样电阻四线连接（Kelvin接法）

## 测试验证

### 基本功能验证

| 测试项 | 测试方法 | 验收标准 | 测试设备 |
|--------|---------|---------|---------|
| 引脚电平 | 万用表测量 | 符合设计电平 | 万用表 |
| PWM波形 | 示波器观测 | 频率/占空比/死区达标 | 示波器 |
| ADC精度 | 标准源比对 | 误差<±0.5%FS | 校准源+万用表 |
| 保护响应 | 故障注入 | 响应时间达标 | 示波器+信号源 |

### 极限测试

| 测试项 | 测试条件 | 验收标准 | 说明 |
|--------|---------|---------|------|
| 高温运行 | 环境温度X°C | 功能正常，参数漂移<X% | 温箱测试 |
| 低温启动 | 环境温度X°C | 正常启动运行 | 温箱测试 |
| EMC抗扰 | IEC 61000-4-x | 不误动作 | EMC实验室 |

## 已知问题与限制

- 限制1：具体描述及对系统的影响
- 限制2：具体描述及规避方法
- 限制3：具体描述及后续改进计划

## 变更历史

| 日期 | 版本 | 作者 | 变更内容 |
|------|------|------|---------|
| YYYY-MM-DD | v1.0 | Yarrow | 初始版本 |

## 相关文档

- [BSP驱动模块文档](../modules/bsp_xxx.md)
- [中间层封装文档](../modules/mdw_xxx.md)
- [系统设计文档](../design/related_design.md)
- GD32G5x3数据手册
- GD32G5x3参考手册